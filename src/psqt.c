/*
  Weiss is a UCI compliant chess engine.
  Copyright (C) 2023 Terje Kirstihagen

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <https://www.gnu.org/licenses/>.
*/

#include "board.h"
#include "evaluate.h"
#include "psqt.h"


extern const int PieceTypeValue[TYPE_NB];


int PSQT[PIECE_NB][64];

// Black's point of view - easier to read as it's not upside down
const int PieceSqValue[6][64] = {

    { S(  0,  0), S(  0,  0), S(  0,  0), S(  0,  0), S(  0,  0), S(  0,  0), S(  0,  0), S(  0,  0),
      S( 73, -5), S( 86,-12), S( 52, 53), S(104,  5), S( 68, 34), S( 86, 21), S(  3, 64), S(-45, 79),
      S( 35, 60), S( 17, 77), S( 54, 30), S( 60,  8), S( 78, 10), S(132, 17), S(103, 67), S( 45, 79),
      S(-17, 46), S(-14, 23), S( -8,  3), S( -1,-21), S( 21,-15), S( 29,-12), S(  4, 17), S(  5, 23),
      S(-28, 18), S(-33, 13), S(-18, -7), S( -9,-19), S( -3,-15), S(  4,-12), S(-16,  1), S(-12, -3),
      S(-35,  6), S(-37,  1), S(-28, -4), S(-26, -5), S(-15,  2), S(-14,  2), S(  1,-12), S(-15,-10),
      S(-19, 13), S( -9, 16), S(-10, 10), S( -8,  9), S(  1, 24), S( 15, 15), S( 30,  5), S( -7, -9),
      S(  0,  0), S(  0,  0), S(  0,  0), S(  0,  0), S(  0,  0), S(  0,  0), S(  0,  0), S(  0,  0) },

    { S(-172,-109), S(-181,  5), S(-146, 31), S(-75, -2), S(-58, 16), S(-108,-35), S(-185, -1), S(-113,-160),
      S(-33, -1), S(-17, 18), S( -6, 20), S(  6, 24), S(  9, -1), S( 35,-12), S( -9,  2), S(-20,-37),
      S(-10,  5), S( 20, 10), S( 11, 53), S( 34, 51), S( 50, 32), S( 64,  6), S( 12, -9), S( -5,-23),
      S( 10, 27), S( 24, 26), S( 47, 47), S( 54, 57), S( 44, 46), S( 73, 38), S( 27, 17), S( 42,  0),
      S( 10, 27), S( 25, 12), S( 29, 50), S( 38, 47), S( 36, 54), S( 49, 31), S( 49, 15), S( 34, 20),
      S(-17, -1), S( -5, 11), S( 10, 22), S( 12, 44), S( 25, 39), S( 19, 13), S( 24,  4), S( 14,  4),
      S(-32,-10), S(-22,  2), S(-14,  5), S(  1, 17), S(  3,  6), S(-15, 12), S(-14, -1), S(  0, 13),
      S(-76,-12), S(-19,-14), S(-25,  4), S(  3, 16), S(  9, 20), S(  7, -6), S(-13, -3), S(-19, -5) },

    { S(-12, 26), S(-54, 33), S(-68, 33), S(-112, 43), S(-114, 42), S(-80, 10), S(-56, 24), S(-64,  2),
      S( -1,  1), S( -9, 26), S( -1, 16), S(-26, 31), S(-16, 12), S(-27, 26), S(-47, 24), S(-61, 12),
      S(  1, 32), S( 30, 17), S( 14, 27), S( 28, 14), S( 16, 23), S( 53, 22), S( 14, 22), S( 20, 11),
      S( -7, 18), S( 23, 27), S( 23, 23), S( 40, 55), S( 39, 25), S( 25, 29), S( 30, 10), S( -4, 19),
      S( 10,  9), S(  0, 19), S( 21, 30), S( 37, 36), S( 26, 35), S( 34, 15), S(  9, 20), S( 42,-13),
      S(  8,  2), S( 43, 25), S( 28, 22), S( 16, 34), S( 26, 38), S( 32, 28), S( 50,  9), S( 37, -6),
      S( 31, -4), S( 24,-20), S( 29, -9), S(  5, 16), S( 14, 16), S( 13, 10), S( 33, -6), S( 34,-31),
      S( 24,-13), S( 42,  6), S( 29, 12), S(  8, 17), S( 29, 11), S( 14, 25), S( 35, -1), S( 47,-40) },

    { S(-15, 71), S(-49, 93), S(-41,100), S(-56, 91), S(-32, 78), S(-35, 87), S(-44, 97), S( -3, 72),
      S(-29, 72), S(-35, 90), S(-31,104), S(-15, 88), S(-38, 89), S(-35, 80), S(-17, 67), S(  8, 48),
      S(-24, 74), S( 12, 68), S( -5, 74), S( -7, 62), S( 21, 47), S( 18, 44), S( 53, 38), S( 31, 26),
      S(-16, 77), S(  5, 69), S(  3, 75), S( -8, 64), S(  9, 39), S( 19, 36), S( 22, 43), S( 18, 34),
      S(-21, 58), S(-25, 63), S(-19, 57), S(-13, 48), S(-12, 42), S(-28, 44), S(  5, 28), S( -8, 25),
      S(-25, 46), S(-18, 38), S(-14, 34), S(-14, 32), S( -5, 23), S( -1,  7), S( 27,-13), S(  7, -6),
      S(-20, 29), S(-15, 41), S(  0, 34), S( -1, 27), S(  8, 16), S(-13, 20), S( 17,  3), S(-11, 10),
      S( -3, 38), S( -7, 35), S( -5, 37), S(  4, 18), S( 10, 11), S(  9, 22), S( 13, 21), S(  0, 17) },

    { S(-61, 92), S(-79,131), S(-50,158), S( -7,133), S(-37,153), S(-84,209), S( -7, 92), S(-53,128),
      S(  2, 34), S(-31, 76), S(-45,149), S(-85,206), S(-102,250), S(-56,183), S(-32,139), S( 16,132),
      S(  9, 41), S( -1, 61), S( -3,113), S(-12,138), S(-12,171), S( 14,164), S( 23,114), S( 34, 85),
      S( -6, 64), S( 19, 65), S( -1, 92), S( -9,130), S( -7,154), S(  6,136), S( 29,141), S( 16,106),
      S( 16, 31), S( -2, 79), S(  1, 80), S( -1,109), S(  1,110), S(  7, 93), S( 25, 86), S( 30, 75),
      S(  6,  6), S( 14, 39), S(  1, 68), S(  0, 66), S(  5, 73), S( 16, 52), S( 40, 25), S( 27, 20),
      S(  7,  3), S( 11,  5), S( 16, 13), S( 17, 42), S( 21, 34), S(  6,-17), S( 34,-78), S( 45,-83),
      S(-15, 13), S(-19, 12), S( -8, 14), S(  5, -1), S( -1,  3), S(-18, -3), S(  4,-32), S( 15,-37) },

    { S(  5,-93), S( -8, 10), S(-35, 53), S(-78,100), S(-21, 78), S(-39,125), S(100, 91), S(191,-116),
      S(-112, 75), S(-37,144), S(-74,174), S( 42,144), S( 53,149), S( 31,189), S( 50,174), S( 81, 92),
      S(-106, 93), S( 11,146), S(-34,181), S(-51,213), S( 14,221), S( 93,188), S( 61,171), S( 40, 83),
      S(-45, 64), S( -6,120), S(-44,172), S(-66,204), S(-56,207), S(  4,180), S(  1,144), S(-83,101),
      S(-37, 42), S( 22, 87), S( 20,129), S(-28,161), S( -9,156), S( 35,127), S(  7,100), S(-110, 83),
      S( 11, 20), S(116, 46), S( 67, 82), S( 48,104), S( 58,101), S( 59, 87), S( 94, 55), S(-12, 45),
      S(106, -6), S(101, 31), S( 94, 47), S( 46, 66), S( 45, 71), S( 71, 55), S(104, 29), S( 77,  3),
      S( 48,-61), S(109,-28), S( 83,  7), S(-30, 27), S( 50, -3), S(  5, 26), S( 85,-20), S( 44,-52) },
};

// Initialize the piece square tables with piece values included
CONSTR(1) InitPSQT() {
    for (PieceType pt = PAWN; pt <= KING; ++pt)
        for (Square sq = A1; sq <= H8; ++sq) {
            int value = PieceTypeValue[pt] + PieceSqValue[pt-1][sq];
            PSQT[MakePiece(WHITE, pt)][MirrorSquare(sq)] =  value;
            PSQT[MakePiece(BLACK, pt)][             sq ] = -value;
        }
}
